# TexCut - Blender Add-on

> **Note:** This project was generated by Claude (Anthropic AI) on behalf of the repository owner.

TexCut creates optimized 2D meshes from images with transparency by following the outline of non-transparent pixels. This significantly reduces pixel overdraw compared to standard quad meshes, making it ideal for scenes with lots of overlapping alpha-masked objects like forests, grass, and foliage.

## Features

- Analyzes image alpha channel to detect non-transparent regions
- Generates mesh geometry that follows the transparency outline
- Automatically applies the image as a texture
- Maintains image aspect ratio
- User-adjustable boundary offset (prevents edge clipping)
- Simple one-click operation from the Image Editor
- **Minimal dependencies** - only requires OpenCV (one-time install)

## Examples

### Leaf Sprite
![Leaf Example](screenshots/Example1-Leaf.png)
*Optimized mesh following the leaf outline, eliminating transparent pixels*

### Tree Billboard
![Tree Example](screenshots/Example2-Tree.png)
*Complex tree shape with efficient geometry matching the visible foliage*

## Installation

### Step 1: Install OpenCV (One-Time Setup)

OpenCV is not included with Blender by default, but installation is simple:

**On Windows:**
1. Open Command Prompt as Administrator
2. Navigate to Blender's Python folder:
   ```
   cd "C:\Program Files\Blender Foundation\Blender 3.x\3.x\python\bin"
   ```
3. Install OpenCV:
   ```
   python.exe -m pip install opencv-python
   ```

**On macOS:**
1. Open Terminal
2. Navigate to Blender's Python folder:
   ```
   cd /Applications/Blender.app/Contents/Resources/3.x/python/bin
   ```
3. Install OpenCV:
   ```
   ./python3.x -m pip install opencv-python
   ```

**On Linux:**
1. Open Terminal
2. Navigate to Blender's Python folder (location varies by installation):
   ```
   cd /usr/share/blender/3.x/python/bin
   ```
3. Install OpenCV:
   ```
   ./python3.x -m pip install opencv-python
   ```

### Step 2: Install the Add-on

1. Download the latest release zip from [Releases](https://github.com/rawnsley/TexCut/releases)
2. In Blender, go to `Edit > Preferences > Add-ons`
3. Click `Install...` and select the downloaded zip file
4. Enable the add-on by checking the checkbox next to "Image: TexCut"

## Requirements

This add-on uses these Python packages:
- `numpy` ✅ (included with Blender)
- `Pillow` (PIL) ✅ (included with Blender)
- `opencv-python` ⚠️ **Requires installation** (see installation instructions above)

Only OpenCV needs to be installed - it's a simple one-time setup using pip.

## Usage

1. Open an image in Blender's **Image Editor**
2. In the Image Editor sidebar (press `N` to toggle), find the **TexCut** panel
3. Click **"Create Mesh from Image"**
4. Adjust settings in the dialog:
   - **Alpha Threshold**: How transparent a pixel needs to be to ignore (default: 0.01)
   - **Boundary Offset**: Extra pixels around the edge to prevent clipping (default: 8px, minimum: 1px)
   - **Maintain Aspect Ratio**: Scale mesh to match image proportions
5. Click **OK**

The add-on will:
- Analyze the alpha channel
- Generate an optimized mesh following the non-transparent regions
- Apply the image as a texture with proper alpha blending
- Add the mesh to your scene

## Benefits

### Reduced Pixel Overdraw
Standard quad meshes render all pixels, including fully transparent ones. TexCut's outline-based meshes only render visible pixels, which can significantly improve performance in scenes with:
- Dense forests and vegetation
- Overlapping foliage cards
- Particle systems with alpha-masked textures
- Billboard sprites

### Performance Impact
In scenes with many overlapping transparent objects, reducing overdraw can lead to:
- Faster rendering times
- Better GPU performance
- Reduced memory bandwidth usage

## Technical Details

The add-on works by:
1. Loading the image and extracting the alpha channel
2. Creating a binary mask based on an alpha threshold
3. Dilating the mask by N pixels (boundary offset) to prevent edge clipping
4. Detecting contours using OpenCV
6. Creating mesh geometry as an n-gon face
7. Setting up UV coordinates for proper texture mapping
8. Configuring shader nodes with alpha clipping

### Why Dilation?
The boundary offset dilation serves two purposes:
1. **Prevents edge clipping** - Ensures texture edges aren't cut off
2. **Reduces self-intersections** - Smooths the boundary to create valid polygons

Testing showed that 1+ pixel dilation prevents 100% of self-intersections across all test images.

## Version History

See [CHANGELOG.md](CHANGELOG.md) for detailed version history.

**Current Version: 2.2.0**
- Removed Shapely dependency (only OpenCV required)
- Minimum boundary offset: 1 pixel (prevents self-intersections)
- Simpler installation
- Smaller package size

## License

This add-on is provided as-is for use in your Blender projects.

## Contributing

Contributions, bug reports, and feature requests are welcome!

## Attribution

This code was generated by Claude (Anthropic AI) on behalf of the repository owner. See [ATTRIBUTION.md](ATTRIBUTION.md) for details.
